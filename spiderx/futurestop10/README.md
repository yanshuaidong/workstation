# üìä ÊúüË¥ßÊ∂®Ë∑åÂπÖTOP10Êï∞ÊçÆÈááÈõÜ

## üìã ÂäüËÉΩËØ¥Êòé

ÊØèÂ§©Ëá™Âä®Ëé∑Âèñ‰∏≠ÂõΩÊúüË¥ßÂ∏ÇÂú∫‰∏≠Ôºå**Ê∂®ÂπÖÊúÄÂ§ßÂâç5‰∏™**Âíå**Ë∑åÂπÖÊúÄÂ§ßÂâç5‰∏™**ÂêàÁ∫¶ÔºàÂÖ±10‰∏™ÔºâÔºåÂπ∂Ôºö
1. Á≠õÈÄâËßÑÂàôÔºöÊ∂®ÂπÖ>1%ÔºåË∑åÂπÖ<-1%
2. ÂÖ•Â∫ìÂà∞ÈòøÈáå‰∫ëMySQLÊï∞ÊçÆÂ∫ìÔºà2‰∏™Ë°®Ôºâ
3. Âú®Êú¨Âú∞SQLiteÂàõÂª∫AIÂàÜÊûê‰ªªÂä°
4. ‰∫§ÁªôChatGPT Helper‰ΩøÁî®ÊµèËßàÂô®ÊêúÁ¥¢Â∑•ÂÖ∑ÂàÜÊûêÂ∏ÇÂú∫Âä®Âõ†

## üéØ Â∫îÁî®Âú∫ÊôØ

ËæÖÂä©‰∫§ÊòìÂÜ≥Á≠ñ‰∏éÂ§çÁõòÔºö
- ‚úÖ Âø´ÈÄü‰∫ÜËß£ÂΩìÂ§©ÂèóÂ∏ÇÂú∫ÂÖ≥Ê≥®ÁöÑÂìÅÁßçÔºàÊ∂®Ë∑åÂπÖ>1%Ôºâ
- ‚úÖ AIÈÄöËøáÊµèËßàÂô®ÊêúÁ¥¢ÂàÜÊûêÊ∂®Ë∑åÂéüÂõ†ÂíåÊñ∞ÈóªÈ©±Âä®
- ‚úÖ ËØÜÂà´Ë°å‰∏öËÅîÂä®ÂíåÂ∏ÇÂú∫ÊÉÖÁª™ÔºàÂå∫ÂàÜÁúüÂÆû‰∫ã‰ª∂vsÂ∏ÇÂú∫Â∞è‰ΩúÊñáÔºâ
- ‚úÖ Ëé∑Âæó3-10Â§©Áü≠Á∫ø‰∫§ÊòìËØÑÂàÜÂª∫ËÆÆÔºà1-10ÂàÜÔºâ
- ‚úÖ ÂèëÁé∞‰∫§ÊòìÊú∫‰ºöÂíåÈ£éÈô©ÁÇπ

## üìä Êï∞ÊçÆÂ∫ìÁªìÊûÑÔºàÂèåÊï∞ÊçÆÂ∫ìÊû∂ÊûÑÔºâ

### üîÑ Êï∞ÊçÆÂ∫ìÂàÜÂ∏É

- **ÈòøÈáå‰∫ëMySQL**: `news_red_telegraph` + `news_process_tracking`ÔºàËøúÁ®ãÂ≠òÂÇ®Ôºâ
- **Êú¨Âú∞SQLite**: `analysis_task`Ôºà‰Ωç‰∫é `spiderx/db/crawler.db`Ôºâ

### 1. news_red_telegraph Ë°® ‚≠ê MySQLÔºàÈòøÈáå‰∫ëÔºâ
Â≠òÂÇ®ÊúüË¥ßÊ∂®Ë∑åTOP10ÁªüËÆ°Êï∞ÊçÆ

| Â≠óÊÆµ | ËØ¥Êòé |
|------|------|
| ctime | ÂÖ•Â∫ìÊó∂Èó¥Êà≥ÔºàÁßíÁ∫ßÔºâ |
| title | Ê†áÈ¢òÔºàÂê´Âπ¥ÊúàÊó•Ôºâ |
| content | Ê∂®Ë∑åÂπÖTOP10ËØ¶ÁªÜÊï∞ÊçÆÔºàÊ†ºÂºèÂåñÊñáÊú¨Ôºâ |
| ai_analysis | AIÂàÜÊûêÁªìÊûúÔºàÈªòËÆ§ÔºöÊöÇÊó†ÂàÜÊûêÔºâ |
| message_type | Ê∂àÊÅØÁ±ªÂûãÔºöÊØèÊó•Ê∂®Ë∑åTOP5ÁªüËÆ° |
| message_label | Ê∂àÊÅØÊ†áÁ≠æÔºöhard |
| message_score | Ê∂àÊÅØËØÑÂàÜÔºö6 |
| market_react | Â∏ÇÂú∫ÂèçÂ∫îÔºàÈªòËÆ§ÔºöNULLÔºâ |

### 2. news_process_tracking Ë°® ‚≠ê MySQLÔºàÈòøÈáå‰∫ëÔºâ
Ë∑üË∏™Êï∞ÊçÆÂ§ÑÁêÜÁä∂ÊÄÅ

| Â≠óÊÆµ | ËØ¥Êòé |
|------|------|
| news_id | ÂÖ≥ËÅînews_red_telegraphË°®ÁöÑid |
| ctime | Ê∂àÊÅØÂàõÂª∫Êó∂Èó¥Êà≥ÔºàÁßíÁ∫ßÔºâ |
| is_reviewed | ÊòØÂê¶Â∑≤ÂÆ°Ê†∏ÔºàÈªòËÆ§Ôºö0Ôºâ |

### 3. analysis_task Ë°® ‚≠ê SQLiteÔºàÊú¨Âú∞Ôºâ
AIÂàÜÊûê‰ªªÂä°Ôºà‰Ωç‰∫é `spiderx/db/crawler.db`Ôºâ

| Â≠óÊÆµ | ËØ¥Êòé |
|------|------|
| title | ‰ªªÂä°Ê†áÈ¢òÔºàÂê´"ÂàÜÊûê"ÂêéÁºÄÔºâ |
| prompt | AIÂàÜÊûêÊèêÁ§∫ËØçÔºàÂåÖÂê´Êñ∞ÈóªÊêúÁ¥¢Ë¶ÅÊ±ÇÔºâ |
| news_time | Êñ∞ÈóªÊó∂Èó¥ÔºàÊ†ºÂºèÔºöYYYY-MM-DD HH:MM:SSÔºâ |
| gemini_analyzed | ÊòØÂê¶ÈúÄË¶ÅGeminiÂàÜÊûêÔºà1=Ë∑≥ËøáGeminiÔºâ |

## ‚è∞ ÂÆöÊó∂‰ªªÂä°

**ÊâßË°åÊó∂Èó¥**: ÊØèÂë®‰∏ÄÂà∞Âë®‰∫î 16:00ÔºàÊúüË¥ßÊî∂ÁõòÂêéÔºâ
**ÊâßË°åÊù°‰ª∂**: ‰ªÖÂú®ÊúüË¥ß‰∫§ÊòìÊó•ÊâßË°å

## üöÄ ‰ΩøÁî®ÊñπÊ≥ï

### 1. ÂÆâË£Ö‰æùËµñ

```bash
cd spiderx/futurestop10
pip install -r requirements.txt
```

### 2. ÊµãËØïËøêË°å

```bash
# ÊâãÂä®ÊâßË°å‰∏ÄÊ¨°ÔºåÊµãËØïÂäüËÉΩ
# Â¶ÇÊûúÊú¨Âú∞Êï∞ÊçÆÂ∫ì‰∏çÂ≠òÂú®‰ºöËá™Âä®ÂàùÂßãÂåñ
python main.py
```

> üí° **ÊèêÁ§∫**: Êú¨Âú∞SQLiteÊï∞ÊçÆÂ∫ìÔºà`spiderx/db/crawler.db`Ôºâ‰∏çÂ≠òÂú®Êó∂‰ºöËá™Âä®ÂàùÂßãÂåñÔºåÊó†ÈúÄÊâãÂä®Êìç‰Ωú

### 3. ÂêØÂä®ÂÆöÊó∂‰ªªÂä°

```bash
# ÂêØÂä®Ë∞ÉÂ∫¶Âô®
chmod +x start_scheduler.sh
./start_scheduler.sh
```

### 4. Êü•ÁúãÊó•Âøó

```bash
# Êü•ÁúãË∞ÉÂ∫¶Âô®Êó•Âøó
tail -f scheduler.log

# Êü•ÁúãÊ†áÂáÜËæìÂá∫
tail -f nohup.out
```

### 5. ÂÅúÊ≠¢‰ªªÂä°

```bash
# ÂÅúÊ≠¢Ë∞ÉÂ∫¶Âô®
chmod +x stop_scheduler.sh
./stop_scheduler.sh
```

## üìù ËæìÂá∫Á§∫‰æã

```
==================================================
„ÄêÊ∂®ÂπÖTOP5„ÄëÔºàÊ∂®ÂπÖ>1%Ôºâ
==================================================
1. jm2605       | ‰ª∑Ê†º:       1064.5 | Ê∂®ÂπÖ: +4.72%
2. ao2601       | ‰ª∑Ê†º:       2552.0 | Ê∂®ÂπÖ: +3.32%
3. sh2603       | ‰ª∑Ê†º:       2179.0 | Ê∂®ÂπÖ: +3.27%
4. j2601        | ‰ª∑Ê†º:       1508.5 | Ê∂®ÂπÖ: +2.27%
5. v2601        | ‰ª∑Ê†º:       4315.0 | Ê∂®ÂπÖ: +2.25%

==================================================
„ÄêË∑åÂπÖTOP5„ÄëÔºàË∑åÂπÖ<-1%Ôºâ
==================================================
1. ag2602       | ‰ª∑Ê†º:      14437.0 | Ë∑åÂπÖ: -3.06%
2. bc2601       | ‰ª∑Ê†º:      81910.0 | Ë∑åÂπÖ: -3.05%
3. cu2601       | ‰ª∑Ê†º:      91550.0 | Ë∑åÂπÖ: -2.69%
4. al2602       | ‰ª∑Ê†º:      21775.0 | Ë∑åÂπÖ: -1.78%
5. zn2601       | ‰ª∑Ê†º:      23305.0 | Ë∑åÂπÖ: -1.27%
```

## üîß ÈÖçÁΩÆËØ¥Êòé

### Êï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºàÂèåÊï∞ÊçÆÂ∫ìÔºâ

#### MySQLÈÖçÁΩÆÔºàÈòøÈáå‰∫ëÔºâ
‰Ωç‰∫é `main.py` ‰∏≠ÁöÑ `MYSQL_CONFIG`Ôºö

```python
MYSQL_CONFIG = {
    'host': 'rm-bp1u701yzm0y42oh1vo.mysql.rds.aliyuncs.com',
    'port': 3306,
    'user': 'ysd',
    'password': 'Yan1234567',
    'database': 'futures',
    'charset': 'utf8mb4'
}
```

#### SQLiteÈÖçÁΩÆÔºàÊú¨Âú∞Ôºâ
‰Ωç‰∫é `main.py` ‰∏≠ÁöÑ `SQLITE_DB_PATH`Ôºö

```python
SQLITE_DB_PATH = Path(__file__).parent.parent / "db" / "crawler.db"
# ÂÆûÈôÖË∑ØÂæÑ: spiderx/db/crawler.db
```

### ÂÆöÊó∂‰ªªÂä°ÈÖçÁΩÆ
‰Ωç‰∫é `scheduler.py` ‰∏≠Ôºö

```python
scheduler.add_job(
    futures_top10_task,
    'cron',
    day_of_week='mon-fri',  # Âë®‰∏ÄÂà∞Âë®‰∫î
    hour=16,                 # 16ÁÇπÔºà‰∏ãÂçà4ÁÇπÔºâ
    minute=0
)
```

## ‚ö†Ô∏è Ê≥®ÊÑè‰∫ãÈ°π

1. **Êï∞ÊçÆÂ∫ìËá™Âä®ÂàùÂßãÂåñ**: Êú¨Âú∞SQLiteÊï∞ÊçÆÂ∫ì‰∏çÂ≠òÂú®Êó∂‰ºöËá™Âä®ÂàùÂßãÂåñÔºàË∞ÉÁî®`spiderx/db/init_db.py`Ôºâ
2. **ÂèåÊï∞ÊçÆÂ∫ìÊû∂ÊûÑ**: 
   - MySQLÔºàÈòøÈáå‰∫ëÔºâÔºöÂ≠òÂÇ®Ê∂®Ë∑åÂπÖÊï∞ÊçÆÂíåÂ§ÑÁêÜÁä∂ÊÄÅ
   - SQLiteÔºàÊú¨Âú∞ÔºâÔºöÂ≠òÂÇ®AIÂàÜÊûê‰ªªÂä°
3. **‰∫§ÊòìÊó•Âà§Êñ≠**: ÁõÆÂâç‰ªÖÊéíÈô§Âë®Êú´ÔºàÂë®‰∏ÄÂà∞Âë®‰∫îÊâßË°åÔºâÔºåÊú™ÊéíÈô§Ê≥ïÂÆöËäÇÂÅáÊó•
4. **Êï∞ÊçÆÂéªÈáç**: ÈÄöËøá`ctime`Â≠óÊÆµÔºàÊó∂Èó¥Êà≥Ôºâ‰øùËØÅÂêå‰∏ÄÊó∂Èó¥Âè™ÂÖ•Â∫ì‰∏ÄÊ¨°
5. **CookieÊúâÊïàÊúü**: APIËØ∑Ê±ÇÁöÑCookieÂèØËÉΩÈúÄË¶ÅÂÆöÊúüÊõ¥Êñ∞
6. **ÁΩëÁªúÁ®≥ÂÆöÊÄß**: Á°Æ‰øùÊúçÂä°Âô®ËÉΩËÆøÈóÆÔºö
   - APIÊé•Âè£Ôºàjiaoyikecha.comÔºâ
   - ÈòøÈáå‰∫ëMySQLÊï∞ÊçÆÂ∫ì
7. **AIÂàÜÊûêÈÖçÁΩÆ**: `gemini_analyzed=1`Ë°®Á§∫Ë∑≥ËøáGeminiÔºåÁî±ChatGPT HelperÂ§ÑÁêÜ

## üì¶ Êñá‰ª∂ËØ¥Êòé

```
spiderx/futurestop10/
‚îú‚îÄ‚îÄ main.py                 # ‰∏ªÁ®ãÂ∫èÔºöÊï∞ÊçÆËé∑ÂèñÂíåÂÖ•Â∫ì
‚îú‚îÄ‚îÄ scheduler.py            # ÂÆöÊó∂‰ªªÂä°Ë∞ÉÂ∫¶Âô®
‚îú‚îÄ‚îÄ start_scheduler.sh      # ÂêØÂä®ËÑöÊú¨
‚îú‚îÄ‚îÄ stop_scheduler.sh       # ÂÅúÊ≠¢ËÑöÊú¨
‚îú‚îÄ‚îÄ requirements.txt        # Python‰æùËµñ
‚îú‚îÄ‚îÄ scheduler.log           # Ë∞ÉÂ∫¶Âô®Êó•Âøó
‚îú‚îÄ‚îÄ scheduler.pid           # ËøõÁ®ãIDÊñá‰ª∂
‚îî‚îÄ‚îÄ README.md              # Êú¨ÊñáÊ°£
```

## üîÑ AIÂàÜÊûêÊµÅÁ®ã

1. **Êï∞ÊçÆÈááÈõÜ**: Ë∞ÉÂ∫¶Âô®ÂÆöÊó∂Ëé∑ÂèñÊ∂®Ë∑åÂπÖÊï∞ÊçÆ
2. **Êï∞ÊçÆÂÖ•Â∫ì**: ÂÜôÂÖ•MySQLÁöÑ2‰∏™Ë°®Ôºà`news_red_telegraph`„ÄÅ`news_process_tracking`Ôºâ
3. **‰ªªÂä°ÂàõÂª∫**: Âú®SQLiteÁöÑ`analysis_task`Ë°®ÂàõÂª∫AIÂàÜÊûê‰ªªÂä°
4. **AIÂàÜÊûê**: ChatGPT HelperËØªÂèñ‰ªªÂä°Âπ∂‰ΩøÁî®ÊµèËßàÂô®ÊêúÁ¥¢Â∑•ÂÖ∑ËøõË°åÂ∏ÇÂú∫ÂàÜÊûê
5. **ÁªìÊûú‰øùÂ≠ò**: ÂàÜÊûêÁªìÊûúÂÜôÂõûÊï∞ÊçÆÂ∫ì

> üí° **ËØ¥Êòé**: `gemini_analyzed=1` Ë°®Á§∫Ë∑≥ËøáGeminiÂàÜÊûêÔºåÁî±ChatGPT HelperÂ§ÑÁêÜ

## üìà Êï∞ÊçÆÊµÅËΩ¨

```
APIÊé•Âè£ (jiaoyikecha.com)
   ‚îÇ
   ‚ñº
Ëé∑ÂèñÂéüÂßãÊï∞ÊçÆÔºàSSEÊµÅÂºèÔºâ
   ‚îÇ
   ‚ñº
Á≠õÈÄâTOP10ÔºàÊ∂®ÂπÖ>1%ÂèñÂâç5ÔºåË∑åÂπÖ<-1%ÂèñÂâç5Ôºâ
   ‚îÇ
   ‚îú‚îÄ‚îÄ‚ñ∫ ÈòøÈáå‰∫ëMySQL (futuresÊï∞ÊçÆÂ∫ì)
   ‚îÇ     ‚îú‚îÄ‚îÄ news_red_telegraphÔºàÊ∂®Ë∑åÂπÖÊï∞ÊçÆ + Ê†ºÂºèÂåñÂÜÖÂÆπÔºâ
   ‚îÇ     ‚îî‚îÄ‚îÄ news_process_trackingÔºàÂ§ÑÁêÜÁä∂ÊÄÅË∑üË∏™Ôºâ
   ‚îÇ
   ‚îî‚îÄ‚îÄ‚ñ∫ Êú¨Âú∞SQLite (spiderx/db/crawler.db)
         ‚îî‚îÄ‚îÄ analysis_taskÔºàAIÂàÜÊûê‰ªªÂä°Ôºâ
                  ‚îÇ    ‚Üë
                  ‚îÇ    ‚îî‚îÄ‚îÄ gemini_analyzed=1ÔºàË∑≥ËøáGeminiÔºâ
                  ‚ñº
             ChatGPT Helper
             ‚îú‚îÄ‚îÄ ‰ΩøÁî®ÊµèËßàÂô®ÊêúÁ¥¢Â∑•ÂÖ∑
             ‚îú‚îÄ‚îÄ Êü•ËØ¢Áõ∏ÂÖ≥Êñ∞Èóª
             ‚îú‚îÄ‚îÄ ÂàÜÊûêÈ©±Âä®Âõ†Á¥†
             ‚îî‚îÄ‚îÄ ÁîüÊàê‰∫§ÊòìËØÑÂàÜ
```


